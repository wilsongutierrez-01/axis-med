---
import AboutBadge from "@/components/badges/AboutBadge.astro";
import DescriptionBadge from "@/components/badges/DescriptionBadge.astro";
import Title from "@/components/fonts/Title.astro";
import { about } from "@/constans/About";
---

<section class="flex flex-col gap-12">
  <Title title="¿Quiénes somos?" />

  <!-- Cambié aquí: mobile = flex-col, desktop (md+) = flex-row -->
  <div class="flex flex-col md:flex-row gap-6">
    <!-- Badges: full width en móvil, 1/4 en md+ -->
    <div
      class="w-full md:w-1/4
         flex gap-4
         overflow-x-auto md:overflow-visible
         flex-row md:flex-col
         scrollbar-hide py-2"
    >
      {
        Object.values(about).map((item) => (
          <div
            data-key={item.key}
            class={`about-badge cursor-pointer shrink-0 md:shrink ${item.visible ? "active" : ""}`}
          >
            <AboutBadge
              active={item.visible}
              icon={item.icon}
              title={item.title}
              bgColor={item.bgColor}
            />
          </div>
        ))
      }
    </div>

    <!-- Descripciones: full width en móvil, 1/2 (o más) en md+ -->
    <div class="w-full md:w-1/2 flex flex-col gap-6">
      {
        Object.values(about).map((item) => (
          <div
            data-description={item.key}
            class={`about-description ${item.visible ? "block" : "hidden"} h-full`}
          >
            <DescriptionBadge
              description={item.description}
              colorBg={item.bgColor}
            />
          </div>
        ))
      }
    </div>
  </div>
</section>

<script type="module">
  // Mantengo tu script tal cual para no cambiar comportamiento
  const badges = document.querySelectorAll(".about-badge");
  const descriptions = document.querySelectorAll(".about-description");

  const defaultKey = "experiencia";
  const defaultBadge = document.querySelector(`[data-key="${defaultKey}"]`);
  const defaultDescription = document.querySelector(
    `[data-description="${defaultKey}"]`
  );

  if (defaultBadge && defaultDescription) {
    defaultBadge.classList.add("active");
    const span = defaultBadge.querySelector("span");
    if (span) span.classList.add("font-bold", "text-xl");
    defaultDescription.classList.remove("hidden");
  }

  badges.forEach((badge) => {
    badge.addEventListener("click", () => {
      const key = badge.dataset.key;

      descriptions.forEach((desc) => desc.classList.add("hidden"));

      const activeDesc = document.querySelector(`[data-description="${key}"]`);
      if (activeDesc) activeDesc.classList.remove("hidden");

      badges.forEach((b) => b.classList.remove("active"));
      badge.classList.add("active");

      badges.forEach((b) => {
        const span = b.querySelector("span");
        if (span) span.classList.remove("font-bold");
      });

      const span = badge.querySelector("span");
      if (span) span.classList.add("font-bold", "text-xl");
    });
  });
</script>
